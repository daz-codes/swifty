<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }} | Swifty</title>
<meta name="turbo-refresh-method" content="morph">
<link rel="stylesheet" href="/css/custom.css" />
<link rel="stylesheet" href="/css/simple.css" />
</head>
<body>
  <header>
    <nav><a href="/about.html" data-turbo-frame="content" data-turbo-action="advance">About</a>
<a href="/posts.html" data-turbo-frame="content" data-turbo-action="advance">Posts</a></nav>
    <h1 class="display-l fancy-font"><a href="/">Swifty</a></h1>
  </header>
    <main>
    <turbo-frame id="content">
  
<turbo-frame id="content">
  <head><title>Index || Swifty</title></head>
  
  <div class="gradient-text display-l text-center">The Simple & Speedy Static Site Generator!</div>

<p>The next generation of static site generator. Simple and Speedy.</p>
<p><img src="/images/lights.jpg" alt="Hazy Lights"></p>
<h2>More Info</h2>
<ul>
<li>Nested urls that follow the structure of the site</li>
<li>Generates index pages for folders automatically</li>
<li>Super fast page navigation (instant page loading!!)</li>
<li>Write content quickly in markdown</li>
<li>Add custom CSS and JavaScript</li>
<li>Layouts</li>
<li>Partials</li>
<li>Pretty urls</li>
<li>Tagging</li>
<li>Helper methods for links to breadcrumbs and other pages</li>
</ul>

  
</turbo-frame>
  
  </turbo-frame>
  </main>
    <footer>
    <p>This site was built with Swifty, the super speedy static site generator.</p>
    <p><a href="/tags.html" data-turbo-frame="content" data-turbo-action="advance">All Tags</a></p>
  </footer>

<script type="module">
  import * as Turbo from 'https://esm.sh/@hotwired/turbo';
  
  // Helper function to convert paths between HTML and clean URLs
  const pathHelpers = {
    toHtmlPath(path) {
      if (path === '/') return '/index.html';
      return path.endsWith('.html') ? path : [object Object].html;
    },
    toCleanPath(path) {
      if (path === '/index.html') return '/';
      return path.endsWith('.html') ? path.replace('.html', '') : path;
    },
    isInternalLink(href) {
      return href && 
        !href.startsWith('#') && 
        !href.startsWith('http') && 
        !href.startsWith('mailto:') && 
        !href.startsWith('tel:');
    }
  };

  // Initialize the app
  document.addEventListener('DOMContentLoaded', () => {
    initializeTurboFrame();
    handleInitialNavigation();
    setupEventListeners();
  });

  // Set up the initial turbo frame based on current URL
  function initializeTurboFrame() {
    const turboFrame = document.querySelector("turbo-frame#content");
    if (!turboFrame) return;
    
    // Add loading class to body when frame starts loading
    turboFrame.addEventListener("turbo:before-frame-render", () => {
    });
    
    // Remove loading class when frame finishes loading
    turboFrame.addEventListener("turbo:frame-render", () => {
    });
    
    // Handle frame errors
    turboFrame.addEventListener("turbo:frame-error", (event) => {
      const path = window.location.pathname;
      turboFrame.innerHTML = 
        <div class="error-container">
          <h1>Page Not Found</h1>
          <p>Sorry, the page "[object Object]" could not be found.</p>
          <a href="/" data-turbo-frame="content">Return Home</a>
        </div>
      ;
    });
  }

  // Handle the initial page load
  function handleInitialNavigation() {
    const turboFrame = document.querySelector("turbo-frame#content");
    if (!turboFrame) return;
    
    const path = window.location.pathname;
    const htmlPath = pathHelpers.toHtmlPath(path);
    
    turboFrame.setAttribute("src", htmlPath);
  }

  // Set up all event listeners
  function setupEventListeners() {
    // Process links after frame loads
    document.addEventListener("turbo:frame-load", (event) => {
      const turboFrame = event.target;
      if (turboFrame.id !== "content") return;
      
      // Update page title from the frame
      updatePageTitle(turboFrame);
      
      // Update URL without appending .html
      updateBrowserURL(turboFrame);
    });
    
    // Handle browser back/forward buttons
    window.addEventListener("popstate", (event) => {
      const path = window.location.pathname;
      const htmlPath = pathHelpers.toHtmlPath(path);
      const turboFrame = document.querySelector("turbo-frame#content");
      
      if (turboFrame) {
        turboFrame.setAttribute("src", htmlPath);
      }
    });
    
    // Handle all click events with event delegation
    document.addEventListener("click", (event) => {
      // Find if a link was clicked
      let link = event.target.closest('a[href]');
      if (!link) return;
      
      const href = link.getAttribute('href');
      
      // Skip non-internal links or links with special attributes
      if (!pathHelpers.isInternalLink(href) || 
          link.hasAttribute('download') || 
          link.getAttribute('target') === '_blank') {
        return;
      }
      
      // Get the HTML path version for the turbo frame
      let htmlHref = pathHelpers.toHtmlPath(href);
      
      // If the link already has the turbo frame attribute, let it work normally
      if (link.hasAttribute('data-turbo-frame')) {
        // Only modify the href if it doesn't already end with .html
        if (!link.getAttribute('href').endsWith('.html')) {
          link.setAttribute('href', htmlHref);
        }
        return;
      }
      
      // Prevent default for links we're handling
      event.preventDefault();
      
      // Set the turbo frame source
      const turboFrame = document.querySelector("turbo-frame#content");
      if (turboFrame) {
        turboFrame.setAttribute("src", htmlHref);
        
        // Update the URL to the clean version
        const cleanPath = pathHelpers.toCleanPath(href);
        window.history.pushState({}, document.title, cleanPath);
      }
    });
  }

  // Update the page title from a turbo frame
  function updatePageTitle(turboFrame) {
    const frameTitle = turboFrame.querySelector("head title");
    if (frameTitle) {
      document.title = frameTitle.textContent;
    }
  }

  // Update the browser URL based on the frame's src
  function updateBrowserURL(turboFrame) {
    const frameSrc = turboFrame.getAttribute("src");
    if (frameSrc) {
      const cleanPath = pathHelpers.toCleanPath(frameSrc);
      window.history.pushState({}, document.title, cleanPath);
    }
  }
</script></body>
</html>
  